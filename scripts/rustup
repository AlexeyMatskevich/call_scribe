#!/usr/bin/env bash
# Fake rustup shim for Serena on NixOS
# Serena requires rustup to find rust-analyzer, but NixOS uses nix store paths

case "$1" in
  "--version")
    echo "rustup-shim 1.0.0 (NixOS compatibility layer)"
    ;;
  "which")
    if [ "$2" = "rust-analyzer" ]; then
      which rust-analyzer
    else
      echo "rustup-shim: unknown tool: $2" >&2
      exit 1
    fi
    ;;
  "component")
    # Pretend to add component
    echo "info: component '$3' is already installed"
    ;;
  *)
    echo "rustup-shim: unsupported command: $1" >&2
    exit 1
    ;;
esac
