#!/usr/bin/env bash
# Wrapper script for Serena MCP server (auto-generated by dev-setup.sh)
# Sets up PATH correctly for NixOS before starting Serena

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PROJECT_DIR="$(dirname "$SCRIPT_DIR")"

# Set PATH with embedded nix store paths from nix develop
# Includes: scripts (rustup shim), rust-analyzer, coreutils, bash, cargo
export PATH="$SCRIPT_DIR:/nix/store/l107fmp3bj88fq80ag7qymr5pppvj031-rust-default-1.92.0-beta.4-2025-12-05/bin:/nix/store/imad8dvhp77h0pjbckp6wvmnyhp8dpgg-coreutils-9.8/bin:/nix/store/rlq03x4cwf8zn73hxaxnx0zn5q9kifls-bash-5.3p3/bin:$HOME/.cargo/bin:$PATH"

# Run Serena MCP server
exec "$PROJECT_DIR/.venv/bin/serena" "$@"
